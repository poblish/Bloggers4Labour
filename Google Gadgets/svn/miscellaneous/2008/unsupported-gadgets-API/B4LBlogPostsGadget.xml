<?xml version="1.0" encoding="UTF-8" ?>
<Module>
<ModulePrefs title="B4L Posts"
	     description="Links to the most recently recommended posts at Bloggers4Labour"
	     title_url="http://www.bloggers4labour.org/"
	     screenshot="http://www.bloggers4labour.org/gadgets/recommendations/screenshot.png"
	     thumbnail="http://www.bloggers4labour.org/gadgets/recommendations/thumbnail.png"
	     author="Andrew Regan"
	     author_email="aregan+coolgadget@gmail.com"
	     height="175">
    <!-- <Require feature="opensocial-0.5" /> -->
    <Require feature="analytics"/>
</ModulePrefs>
<Content type="html">
<![CDATA[
<script>
_IG_Analytics("UA-159388-1", "/widget_B4LBlogPosts");
</script>

<script type="text/javascript" src="http://www.google.com/jsapi"></script>

<script type="text/javascript"> 
google.load("gdata", "1.x");

function logMeIn() {
  scope = "http://www.blogger.com/feeds";
  var token = google.accounts.user.login(scope);
}

function setupMyService() {
  var myService = new google.gdata.blogger.BloggerService('exampleCo-exampleApp-1');
  logMeIn();
  return myService;
}

function getMyBlogFeed() {
  myService = setupMyService();

  var myBlogFeedUri = "http://www.blogger.com/feeds/default/blogs";
  myService.getBlogFeed( myBlogFeedUri, handleMyBlogFeed, handleError);
}

function handleMyBlogFeed(myResultsFeedRoot) {
  var firstBlog = myResultsFeedRoot.feed.getEntries()[0];
  firstBlogID = firstBlog.getId().getValue();
  alert("The first blog's title is: " +
    firstBlog.getTitle().getText());
}

gadgets.util.registerOnLoadHandler( getMyBlogFeed );
</script>

]]>
</Content>
</Module>